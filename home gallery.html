<style>
  @import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css");
  @import url("https://fonts.googleapis.com/css2?family=League+Spartan:wght@100..900&display=swap");

  body {
    font-family: "League Spartan", sans-serif;
  }
  .homeGal {
    display: flex;
    gap: 30px;
    justify-content: center;
  }
  .featureImage {
    flex: 1;
    aspect-ratio: 2/1;
    overflow: hidden;
    cursor: pointer;
  }
  .featureImage > img {
    width: 100%;
    filter: grayscale(100%);
    transition: all 0.3s ease;
    aspect-ratio: 2/1;
  }
  .gallery-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
    flex: 1;
  }
  .timer {
    height: 2px;
    background: red;
    width: 0%;
  }
  .fa-pause {
    display: none;
  }
  .gallery-item {
    cursor: pointer;
    overflow: hidden;
    background: #111;
  }
  .captionName {
    font-size: 16px;
    display: flex;
    text-align: center;
    justify-content: center;
    align-items: center;
    gap: 10px;
    margin-bottom: 12px;
  }
  .gallery-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: grayscale(100%);
    transition: all 0.3s ease;
    aspect-ratio: 1/1;
  }

  .gallery-item:hover img,
  .featureImage:hover > img {
    transform: scale(1.05);
    filter: grayscale(0%);
  }

  .gallery-modal {
    position: fixed;
    inset: 0;
    z-index: 9999;
    display: flex;
    opacity: 0;
    top: 100%;
    transition: all 0.3s ease;
  }

  .imageContainer {
    display: flex;
    flex-direction: column;
  }

  .right-controls {
    display: flex;
    background: rgba(30, 30, 30, 0.6);
    gap: 20px;
    padding: 10px;
  }
  .right-controls i {
    font-size: 16px;
    cursor: pointer;
  }
  #thumbToggle {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1px;
    cursor: pointer;
  }
  #thumbToggle > div {
    width: 4px;
    height: 4px;
    background: #eee;
  }
  .gallery-modal.active {
    opacity: 1;
    top: 0;
  }
  #prevBtn,
  #nextBtn {
    z-index: 999;
  }
  .gallery-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.8);
  }

  .modal-content {
    position: relative;
    display: flex;
    color: #fff;
    flex-direction: column;
    height: 100vh;
    width: 100%;
  }

  .control-bar {
    display: flex;
    align-items: center;
    width: 100%;
    justify-content: space-between;
    z-index: 99999;
    padding: 0 0 0 10px;
  }

  .main-image-wrapper {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    gap: 10px;
  }

  .main-image.grabbing {
    cursor: grabbing;
  }
  .main-image:hover {
    cursor: grab;
  }

  .main-image {
    object-fit: contain;
    max-width: 100%;
    transition: transform 0.25s ease;
    touch-action: none;
  }
  .caption-mobile {
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translate(-50%);
    display: none;
    max-width: calc(100% - 40px);
    background: linear-gradient(
      0deg,
      rgba(0, 0, 0, 0.85) 0px,
      rgba(0, 0, 0, 0.3) 50%,
      rgba(0, 0, 0, 0.15) 65%,
      rgba(0, 0, 0, 0.075) 75.5%,
      rgba(0, 0, 0, 0.035) 82.85%,
      rgba(0, 0, 0, 0.02) 88%,
      transparent
    );
  }
  .caption-mobile,
  .caption {
    text-align: center;
    max-width: 800px;
    width: 100%;
  }
  .caption {
    margin-top: 20px;
  }
  .caption h3 {
    margin: 0;
    font-weight: 600;
    line-height: 1.2;
  }

  .caption h3,
  .caption .story {
    font-size: 16px;
    line-height: 19.2px;
    color: #eee;
  }

  .control {
    background: rgba(0, 0, 0, 0.6);
    border: none;
    color: #fff;
    font-size: 16px;
    cursor: pointer;
    padding: 6px;
  }

  .prev {
    left: -60px;
  }
  .next {
    right: -60px;
  }

  .thumbnail-panel {
    max-height: 100vh;
    width: 0;
    gap: 2px;
    background: rgb(0, 0, 0, 0.3);
    overflow-y: auto;
    display: grid;
    z-index: 10000;
    grid-template-columns: repeat(2, 1fr);
    overflow-x: hidden;
    padding: 2px 2px 20px;
    opacity: 0;
    transition: all 0.3s;
    transform: translateX(300px);
  }

  .thumbnail-panel::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  .thumbnail-panel::-webkit-scrollbar-track {
    background: black;
    border-radius: 10px;
  }

  .thumbnail-panel::-webkit-scrollbar-thumb {
    background: grey;
    border-radius: 10px;
  }

  .thumbnail-panel::-webkit-scrollbar-thumb:hover {
    background: rgb(55, 54, 54);
  }

  .thumbnail-panel.active {
    opacity: 1;
    transform: translateX(0);
    min-width: 208px;
  }

  .thumbnail {
    overflow: hidden;
    cursor: pointer;
    width: 100px;
    height: 75px;
  }

  .thumbnail img {
    width: 100%;
    object-fit: cover;
  }

  @media (max-width: 768px) {
    .modal-content {
      flex-direction: column;
      align-items: center;
    }

    .thumbnail-panel {
      grid-template-columns: repeat(1, 1fr);
      transform: translateX(200px);
    }
    .thumbnail-panel.active {
      min-width: 104px;
    }
    .caption h3,
    .caption .story {
      font-size: 14px;
      line-height: 16px;
    }
    .captionName {
      margin-bottom: 8px;
    }
    .caption-mobile {
      display: block;
    }
    .caption {
      margin-top: 15px;
      display: none;
    }
    .featureImage {
      display: none;
    }
    .gallery-grid {
      grid-template-columns: repeat(auto-fill, minmax(225px, 1fr));
    }
  }
</style>

<div class="homeGal">
  <div class="featureImage">
    <img src="" alt="" />
  </div>
  <div class="gallery-grid" id="galleryGrid"></div>
</div>

<div class="gallery-modal" id="galleryModal">
  <div class="gallery-overlay"></div>

  <div class="modal-content">
    <div class="timer"></div>
    <div class="control-bar">
      <div class="counter"></div>
      <div class="right-controls">
        <i class="fa-solid fa-magnifying-glass"></i>
        <i class="fa-solid fa-play"></i>
        <i class="fa-solid fa-pause"></i>
        <i class="fa-solid fa-x" id="closeBtn"></i>
        <div id="thumbToggle">
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
        </div>
      </div>
    </div>
    <div class="main-image-wrapper">
      <button class="control prev" id="prevBtn">
        <i class="fa-solid fa-arrow-left"></i>
      </button>
      <div class="imageContainer">
        <img class="main-image" id="mainImage" src="" alt="" />
        <div class="caption">
          <div class="captionName">
            <h3 id="captionNameDesktop"></h3>
            <div class="ig" id="captionIgDesktop"></div>
          </div>
          <div class="story" id="captionStoryDesktop"></div>
        </div>
      </div>
      <div class="caption-mobile">
        <div class="captionName">
          <h3 id="captionName"></h3>
          <div class="ig" id="captionIg"></div>
        </div>
        <div class="story" id="captionStory"></div>
      </div>
      <button class="control next" id="nextBtn">
        <i class="fa-solid fa-arrow-right"></i>
      </button>
    </div>
  </div>
  <div class="thumbnail-panel" id="thumbnailPanel"></div>
</div>

<script>
  const galleryData = window.galleryData || [];
  const featureImageSrc = window.featureImage || [];
  let currentIndex = 0;

  const grid = document.getElementById("galleryGrid");
  const modal = document.getElementById("galleryModal");
  const mainImage = document.getElementById("mainImage");
  const captionName = document.getElementById("captionName");
  const captionIg = document.getElementById("captionIg");
  const captionStory = document.getElementById("captionStory");
  const captionNameDesktop = document.getElementById("captionNameDesktop");
  const captionIgDesktop = document.getElementById("captionIgDesktop");
  const captionStoryDesktop = document.getElementById("captionStoryDesktop");
  const thumbnailPanel = document.getElementById("thumbnailPanel");
  const counter = document.querySelector(".counter");
  const featureImage = document.querySelector(".featureImage");
  featureImage.querySelector("img").src = featureImageSrc;
  galleryData.forEach((item, index) => {
    const div = document.createElement("div");
    div.className = "gallery-item";
    div.innerHTML = `<img src="${item.image}" alt="">`;
    div.onclick = () => openModal(index);
    grid.appendChild(div);
  });

  galleryData.forEach((item, index) => {
    const div = document.createElement("div");
    div.className = "thumbnail";
    div.innerHTML = `<img src="${item.image}" alt="">`;
    div.onclick = () => showImage(index);
    thumbnailPanel.appendChild(div);
  });

  featureImage.onclick = () => {
    modal.classList.add("active");
    document.body.style.overflow = "hidden";
    mainImage.src = featureImage.querySelector("img").src;
    counter.textContent = ``;
    captionNameDesktop.textContent = "";
    captionIgDesktop.textContent = "";
    captionStoryDesktop.textContent = "";
    captionName.textContent = "";
    captionIg.textContent = "";
    captionStoryDesktop.textContent = "";
    [".next", ".prev"].forEach((selector) => {
      const btn = document.querySelector(selector);
      btn.style.opacity = 0;
    });
    [".fa-play", "#thumbToggle"].forEach((selector) => {
      const btn = document.querySelector(selector);
      btn.style.display = "none";
    });
  };

  function openModal(index) {
    modal.classList.add("active");
    document.body.style.overflow = "hidden";
    showImage(index);
  }

  function closeModal() {
    modal.classList.remove("active");
    thumbnailPanel.classList.remove("active");
    document.body.style.overflow = "";
  }

  document.getElementById("prevBtn").onclick = () => {
    showImage((currentIndex - 1 + galleryData.length) % galleryData.length);
    if (isZoomed) {
      resetImage();
    }
  };

  document.getElementById("nextBtn").onclick = () => {
    showImage((currentIndex + 1) % galleryData.length);
    if (isZoomed) {
      resetImage();
    }
  };

  document.getElementById("closeBtn").addEventListener("click", () => {
    closeModal();

    resetImage();
    ["#nextBtn", "#prevBtn"].forEach((selector) => {
      const btn = document.querySelector(selector);
      btn.style.opacity = 1;
    });
    playBtn.style.display = "block";
    thumbToggle.style.display = "grid";
  });

  document.getElementById("thumbToggle").onclick = () => {
    thumbnailPanel.classList.toggle("active");
  };

  document.querySelector(".gallery-overlay").onclick = closeModal;

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") closeModal();
  });
  const zoomBtn = document.querySelector(".fa-magnifying-glass");

  let isZoomed = false;
  let isDragging = false;

  let startX = 0;
  let startY = 0;
  let translateX = 0;
  let translateY = 0;

  const ZOOM_SCALE = 2;
  const MOVEMENT_SENSITIVITY = 1.5;

  zoomBtn.addEventListener("click", () => {
    if (isZoomed) {
      resetImage();
    } else {
      isZoomed = true;
      applyTransform();
    }
  });

  mainImage.addEventListener("pointerdown", (e) => {
    if (!isZoomed) return;

    isDragging = true;
    mainImage.setPointerCapture(e.pointerId);

    startX = e.clientX - translateX;
    startY = e.clientY - translateY;

    mainImage.classList.add("grabbing");
    e.preventDefault();
  });

  mainImage.addEventListener("pointermove", (e) => {
    if (!isDragging || !isZoomed) return;

    translateX = (e.clientX - startX) * MOVEMENT_SENSITIVITY;
    translateY = (e.clientY - startY) * MOVEMENT_SENSITIVITY;

    applyTransform();
    e.preventDefault();
  });

  function stopDragging(e) {
    if (!isDragging) return;

    isDragging = false;
    mainImage.classList.remove("grabbing");

    if (e?.pointerId !== undefined) {
      mainImage.releasePointerCapture(e.pointerId);
    }
  }

  mainImage.addEventListener("pointerup", stopDragging);
  mainImage.addEventListener("pointercancel", stopDragging);
  window.addEventListener("blur", stopDragging);

  function applyTransform() {
    mainImage.style.transform = `translate(${translateX}px, ${translateY}px) scale(${ZOOM_SCALE})`;
    mainImage.style.height = `${window.innerHeight * 0.8}px`;
    mainImage.style.zIndex = 90;
  }

  function resetImage() {
    isZoomed = false;
    isDragging = false;
    translateX = 0;
    translateY = 0;
    mainImage.classList.remove("grabbing");
    mainImage.style.transition = "transform 0.3s ease";
    mainImage.style.transform = "translate(0, 0) scale(1)";
    mainImage.style.zIndex = 0;
    adjustImageHeight();
    setTimeout(() => {
      mainImage.style.transition = "";
    }, 300);
  }

  const playBtn = document.querySelector(".fa-play");
  const pauseBtn = document.querySelector(".fa-pause");
  const timerBar = document.querySelector(".timer");

  let slideshowInterval = null;
  let timerInterval = null;
  const duration = 3000;

  function showImage(index) {
    if (!galleryData || !galleryData.length) return;

    currentIndex =
      ((index % galleryData.length) + galleryData.length) % galleryData.length;
    const item = galleryData[currentIndex];
    counter.textContent = `${currentIndex + 1} / ${galleryData.length}`;

    mainImage.src = item.image;

    if (window.innerWidth >= 768) {
      captionNameDesktop.textContent = item.name;
      captionIgDesktop.textContent = item.instagram
        ? `(${item.instagram})`
        : "";
      captionStoryDesktop.textContent = item.story;
      adjustImageHeight();
    } else {
      captionName.textContent = item.name;
      captionIg.textContent = item.instagram ? `(${item.instagram})` : "";
      captionStory.textContent = item.story;

      mainImage.style.height = `${window.innerHeight * 0.8}px`;
    }
  }

  function adjustImageHeight() {
    const lineHeight =
      parseInt(getComputedStyle(captionStoryDesktop).lineHeight, 10) || 20;
    const lines = Math.ceil(captionStoryDesktop.scrollHeight / lineHeight);

    const extraPerLine = 20;
    mainImage.style.height = `${window.innerHeight * 0.8 - (lines - 1) * extraPerLine}px`;
    console.log(lines);
  }

  function startSlideshow() {
    playBtn.style.display = "none";
    pauseBtn.style.display = "block";

    let timerWidth = 0;
    const step = 100 / (duration / 30);

    timerInterval = setInterval(() => {
      timerWidth += step;
      if (timerWidth > 100) timerWidth = 100;
      timerBar.style.width = `${timerWidth}%`;
    }, 30);

    slideshowInterval = setInterval(() => {
      currentIndex = (currentIndex + 1) % galleryData.length;
      showImage(currentIndex);
      timerWidth = 0;
    }, duration);
  }

  function stopSlideshow() {
    if (featureImage.querySelector("img").src !== mainImage.src) {
      playBtn.style.display = "block";
    }
    pauseBtn.style.display = "none";
    clearInterval(slideshowInterval);
    clearInterval(timerInterval);
    timerBar.style.width = "0%";
  }

  playBtn.addEventListener("click", () => {
    startSlideshow();
  });

  pauseBtn.addEventListener("click", () => {
    stopSlideshow();
  });

  [
    ".fa-magnifying-glass",
    "#thumbToggle",
    "#closeBtn",
    ".fa-arrow-right",
    ".fa-arrow-left",
  ].forEach((selector) => {
    const el = document.querySelector(selector);
    if (el) {
      el.addEventListener("click", stopSlideshow);
    }
  });

  showImage(currentIndex);
</script>

<script>
  window.featureImage =
    "https://storage.googleapis.com/msgsndr/j9p19hXkEuCcFq1I48uW/media/697a5be3a1d79e32dcbfe58a.jpg";
  window.galleryData = [
    {
      image:
        "https://storage.googleapis.com/msgsndr/j9p19hXkEuCcFq1I48uW/media/697a421fb700a222086c6603.jpg",
      name: "Lane Harris 1",
      instagram: "",
      story:
        "Lane says this is a tattoo that was created for remembrance of those who he's served with and have fallen both inside and outside of the military, specifically a gentleman named lane Harris, for the battle cross.",
    },
    {
      image:
        "https://storage.googleapis.com/msgsndr/j9p19hXkEuCcFq1I48uW/media/697a421f1fd8278085651373.jpg",
      name: "Lane Harris 2",
      instagram: "",
      story:
        "Lane says 'the eagles head is to resemble a multitude of things, from staying sharp, to patriotic, to majestic. The uncle Sam’s skull is in reference to dying for what America stands for in the traditional sense. Freedom from government and being free people. Then design around the eagles head is more or less a design feature to tie them all together.'",
    },

    {
      image:
        "https://storage.googleapis.com/msgsndr/j9p19hXkEuCcFq1I48uW/media/697a421ff215da91ac4b9602.jpg",
      name: "Justin Brant",
      instagram: "@jab_trd_socal",
      story:
        "Justin Brant says after joining the Marines back in 2001, he got his first tattoo in MOS school. He says it was cool as a young one…but he didn’t really like it and after a few years he ended up covering it up. A few year later he had some laser tattoo removal sessions to lighten the double tattoo. In the meantime, him and San Diego tattoo artist (IG: @terryribera) sat down and planned the tattoo out. 'He actually texted me a few weeks later before the first appointment and had changed the design to something more in your face and dynamic. I was in love with the design! At this point in my career I had been on 7 deployments and seen over 30 countries with just about 16-17 years in service. 3 sessions later I was so proud to wear this new ink from Terry that represents who I am. I fully believe that even long after the military I’ll still be a Marine and hold that true.”",
    },

    {
      image:
        "https://storage.googleapis.com/msgsndr/j9p19hXkEuCcFq1I48uW/media/697a421fe1783c54b321e7b0.jpg",
      name: "Chris",
      instagram: "",
      story:
        "'I am a 100% SC medically retired medic. I have a beautiful wife of 20 years and six awesome children with our first grandchild on the way! My tattoo represents my own personal struggles, diagnosis, thoughts, experiences, friends, comrades, family and so on. We all have these experiences whether personally or by a loved one. It’s time we bring attention to those who don’t know and are unaware what their family members could be going through.'",
    },

    {
      image:
        "https://storage.googleapis.com/msgsndr/j9p19hXkEuCcFq1I48uW/media/697a421fa1d79eed22b9f607.jpg",
      name: "Jeremiah",
      instagram: "@amped2bfit",
      story:
        "'This is for all that gave ALL. The dog tags are my grandfather’s who was a fighter pilot in the Marines. God bless the USA'",
    },

    {
      image:
        "https://storage.googleapis.com/msgsndr/j9p19hXkEuCcFq1I48uW/media/697a421f1927c87dfb454cf2.jpg",
      name: "Amy Shackles",
      instagram: "",
      story:
        "'My Dad was in the Air Force. I got my tattoo for him, a month before he passed away. He never really liked that I had tattoos but he said this one was really cool and he loved it. I am very passionate about Veterans, they deserve the utmost respect and gratitude. I thank all Veterans for their service to our country.'",
    },

    {
      image:
        "https://storage.googleapis.com/msgsndr/j9p19hXkEuCcFq1I48uW/media/697a421f266d737a73f8d4e8.jpg",
      name: "Matthew Davies",
      instagram: "",
      story:
        "Matthew got this tattoo to represent his time in the Navy. 'This piece means a lot because the navy helped me do and see things I never would have been able to by myself. This piece also has another amazing story because it was done by a Purple Heart recipient from Army/Marine Corp who helps take care of local veterans.'",
    },

    {
      image:
        "https://storage.googleapis.com/msgsndr/j9p19hXkEuCcFq1I48uW/media/697a421f3f6f18d5f47d1b1b.jpg",
      name: "Daniel Chavez",
      instagram: "",
      story:
        "For Daniel, the skull at the top represents the infantry soldiers who gave their lives and are looking over the living soldiers while in battle and at home, which are the soldiers at the bottom. They also represent the brotherhood created while overseas and always having each other’s back. The background is the American flag which represents what they all fight/fought for and what they hold dear to their heart. As well as being a proud American. The 'infantry' at the top just represents his job in the army and his pride for it.",
    },
  ];
</script>
